\include{settings}
\usepackage{amsmath}

\begin{document}	% начало документа

% Титульная страница
\include{titlepage}

% Содержание
\include{ToC}


\section{Цель работы}
Познакомиться со средствами генерации и визуализации простых сигналов.


\section{Теоретическая информация}
Аналоговый сигнал с математической точки зрения представляет собой функцию (как правило - функцию времени), и при его дискретизации мы получаем отсчеты, являющиеся значениями этой функции, вычисленными в дискретные моменты времени. Поэтому для расчета дискретезированного сигнала необходимо прежде всего сформировать вектор дискретных значний времени. Сформировав его, можно вычислять значения сигнала, используя этот вектор в различных фомрулах.
Рассмотрим математические формулы некоторых сигналов, которые будут построены в данной работе.


 Для формирования затухающей синусоиды задаим синус с соответствующей начальной фазой:
\begin{equation} s1 = A * cos(2  * \pi * f0 * t + phi) \end{equation}
А затем домножим синусоиду(1) на экспоненту:
\begin{equation} s2 = \exp(-alpha * t) * s1 \end{equation}
Для задания экспоненциального импульса воспользуемся следующим выражением:
\begin{equation} s = A * \exp(-alpha * t) , t >=0 \end{equation}
Прямоугольный импульс зададим следующим образом:
\begin{equation} s = A *  |t|,  |t| <= \frac{T}{2}  \end{equation}
Несимметричный треугольный импульс можно рассчитать по следующей формуле:
\begin{equation} s = A * \frac{t}{T}, 0 <= t <= T \end{equation}

Треугольный импульс, в общем случае, имеет следующий вид:
\begin{equation*}
y = 
 \begin{cases}
   \frac{2t + width}{width(skew + 1)}, -\frac{width}{2} <= t < \frac{width * skew}{2}\\
   \frac{2t - width}{width(skew - 1)} , \frac{width * skew}{2} <= t < \frac{width}{2}\\
    0, |t| > \frac{width}{2}
 \end{cases}
\end{equation*}
Здесь, \textit{width} - ширина импульса, а \textit{skew} - коэффициент асимметрии импульса. Соотвественно меняя данные параметры можем получать импульсы нужной нам длительности и с нужным положеним вершины.

В данной работе так же затрагивается гауссов радиоимпульс, вектор рассчитанных значений которого
определяется по следующей формуле:
\begin{equation} y = \exp(-a t^2) * cos(2\pi f_c t) \end{equation}

Достаточно интересной является функция Дирихле, зависящая не только от параметра \textit{x}, но и от \textit{n}, которое является целым положительным числом. Данная функция описывается следующей фомрулой:
\begin{equation} diric_n (x) = \frac{sin(n x/2)}{n sin(x/2)} \end{equation}

В данной работе будем рассматривать спектры простейших сигналов. Для построения спектра в осях амплитуда-частота, необходимо воспользоваться разложением в ряд Фурье. Ряд фурье может быть применен не только для периодических сигналов, но и для сигналов конечной длительности. При этом оговаривается промежуток, для которого этот ряд строится, во все остальное время сигнал считается равным нолю. Существует несколько форм записи ряда Фурье, однако целесообразнее записать его комплексную форму:
\begin{equation} s(t) = \sum\limits_{k=-\infty}^\infty C_k \exp(-jk\omega t) \end{equation}
Амплитуды $A_k$ и фазы $\varphi_k$ связаны с коэффициентами ряда $C_k$ следующим образом:
\begin{equation} C_k = \frac{1}{2}A_k exp(j \varphi_k) \end{equation}
\begin{equation} A_k = 2|C_k| \end{equation}
\section{Ход выполнения работы}
Для начала научимся строить простейшие сигналы и изучим саму процедуру построения. Сформируем сигнал, описанный формулой (2), при помощи языка \textit{Python}:

\lstinputlisting[
	label=code:Plot1,
	caption={Plot1.py},% для печати символ '_' требует выходной символ '\'
]{Plot1.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

Получаем следующие результаты(Рисунок.~\ref{pic:Plot1}):

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot1}
		\caption{Гармонический сигнал представленный различными графическими функциями} 
		\label{pic:Plot1} % название для ссылок внутри кода
	\end{center}
\end{figure}
Наблюдаем гаромонический сигнал, который затухает по экспоненте из-за домножения его на экспоненту. Построим спектр данного сигнала. На графике ожидаем увидеть ярко-выраженную амплитуду частоты заданной в коде программы. Результаты рассмотрим на Рисунке.~\ref{pic:Plot1_spec}
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot1_spec}
		\caption{Спектр гармонического сигнала} 
		\label{pic:Plot1_spec} % название для ссылок внутри кода
	\end{center}
\end{figure}

Продолжая изучать графические возможности пакета, попробуем построить косинусы различной частоты(Рисунок.~\ref{pic:Plot2}):

\lstinputlisting[
	label=code:Plot2,
	caption={Plot2.py},% для печати символ '_' требует выходной символ '\'
]{Plot2.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot2}
		\caption{Косинусы различной частоты} 
		\label{pic:Plot2} % название для ссылок внутри кода
	\end{center}
\end{figure}
Ограничимся тремя косинусами и рассмотрим их спектр.(Рисунок.~\ref{pic:Plot2_spec})
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot2_spec}
		\caption{Спектры косинусы различной частоты} 
		\label{pic:Plot2_spec} % название для ссылок внутри кода
	\end{center}
\end{figure}

Как и ожидалось, наблюдаем наивысшые амплитуды сигналов в трех разных местах, соотвествущих частотам, заданным в коде программы.

Довольно часто необходимо изучать сигналы, которые на разных интервалах времени задаются разными формулами, таким образом, есть необходимость в  рассмотрении построения кусочных зависимостей. Ниже представлены следущие импульсы(Рисунок.~\ref{pic:Plot3}), формулы которых представлены выше:
\begin{itemize}
\item Экспоненциальный
\item Прямоугльный, центрированный относительно начала отсчета времени
\item Несимметричный треугольный импульс
\end{itemize}

Зададим их следующим кодом:

\lstinputlisting[
	label=code:Plot3,
	caption={Plot3.py},% для печати символ '_' требует выходной символ '\'
]{Plot3.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot3}
		\caption{Различные виды импульсов} 
		\label{pic:Plot3} % название для ссылок внутри кода
	\end{center}
\end{figure}

Их спектры, соответсвенно представлены ниже на Рисунках.~\ref{pic:Plot3_spec1},.~\ref{pic:Plot3_spec2},.~\ref{pic:Plot3_spec3}.
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot3_spec1}
		\caption{Спектр экспоненциального импульса} 
		\label{pic:Plot3_spec1} % название для ссылок внутри кода
	\end{center}
\end{figure}
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot3_spec2}
		\caption{Спектр прямоугольного импульса} 
		\label{pic:Plot3_spec2} % название для ссылок внутри кода
	\end{center}
\end{figure}
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot3_spec3}
		\caption{Спектр несимметричного треугольного импульса} 
		\label{pic:Plot3_spec3} % название для ссылок внутри кода
	\end{center}
\end{figure}

Рассмотрим различные одиночные импульсы. К сожалению, пакет signal языка Python не умеет строить одиночные импульсы, поэтому задавать такого вида импульсы будем вручную. Первый на очереди - прямоугольный импульс. С помощью сложения двух прямоугольных импульсов с разнополярными амплитудами получаем следующий Рисунок.~\ref{pic:Plot4}


\lstinputlisting[
	label=code:Plot4,
	caption={Plot4.py},% для печати символ '_' требует выходной символ '\'
]{Plot4.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot4}
		\caption{Пара разнополярных прямоугольных импульсов} 
		\label{pic:Plot4} % название для ссылок внутри кода
	\end{center}
\end{figure}

Так же рассмотрим спектр данного импульса.(Рисунок.~\ref{pic:Plot4_spec})
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot4_spec}
		\caption{Спектр импульса, полученного путем сложения двух разнополярных прямоугольных импульсов} 
		\label{pic:Plot4_spec} % название для ссылок внутри кода
	\end{center}
\end{figure}
Спектр такого импульса получился очень похожим на спектр обыкновенного прямоугольного импульса.

Аналогичную процедуру проводим и для треугольного импульса, так же задавая функцию вручную по формуле представленной выше. Далее  используем нашу функцию для задания трапецевидного импульса(Рисунок.~\ref{pic:Plot5})

\lstinputlisting[
	label=code:Plot5,
	caption={Plot5.py},% для печати символ '_' требует выходной символ '\'
]{Plot5.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot5}
		\caption{Трапецевидный импульс} 
		\label{pic:Plot5} % название для ссылок внутри кода
	\end{center}
\end{figure}



Если же нам необходимо  сформировать сигнал, кототрый имеет ограниченный по частоте спектр, можем использовать следующую функцию: \begin{equation} y = sinc(x) = \frac{sin(\pi  x)}{\pi x} \end{equation}

Формируем радиоимпульс путем домножения прямоугольного импульса на косинус(Рисунок.~\ref{pic:Plot6_1}) и строим с помощью этой функции(11) амплитудный спектр(Рисунок.~\ref{pic:Plot6_2}).

\lstinputlisting[
	label=code:Plot6,
	caption={Plot6.py},% для печати символ '_' требует выходной символ '\'
]{Plot6.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot6_1}
		\caption{Одиночный радиоимпульс} 
		\label{pic:Plot6_1} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot6_2}
		\caption{Амплитудный спектр} 
		\label{pic:Plot6_2} % название для ссылок внутри кода
	\end{center}
\end{figure}

Видим, что спектр оказался несимметричным относильно частоты заполнения радиоимпульса.

Продолжим изучения различных импульсов построив одиночный радиоимпульс с гауссовой огибающей при помощи встроенной функции из пакета signal(Рисунок.~\ref{pic:Plot7_1}). Так же построим его спектр((Рисунок.~\ref{pic:Plot7_2})).


\lstinputlisting[
	label=code:Plot7,
	caption={Plot7.py},% для печати символ '_' требует выходной символ '\'
]{Plot7.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot7_1}
		\caption{Гауссов радиоимпульс} 
		\label{pic:Plot7_1} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot7_2}
		\caption{Амплитудный спектр} 
		\label{pic:Plot7_2} % название для ссылок внутри кода
	\end{center}
\end{figure}

Спектр был построен при помощи быстрого преобразования Фурье из пакета signal. Так же был подсчитан максимальный уровень спектра в децибелах на граничных частотах. Границы спектра отображены на рисунке двумя точками.

После изучения одиночных импульсов целесообразно изучить последовательности импульсов. Для примера рассмотрим последовательность треугольных импульсов с различными амплитудами и задержками:

\lstinputlisting[
	label=code:Plot12,
	caption={Plot12.py},% для печати символ '_' требует выходной символ '\'
]{Plot12.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

В отличие от MATLAB Python не имеет функции pulsetran. В связи с этим данную функцию опять же пришлось писать вручную. Результаты постороения отображены на Рисунок.~\ref{pic:Plot12}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot12}
		\caption{Последовательность треугольных импульсов} 
		\label{pic:Plot12} % название для ссылок внутри кода
	\end{center}
\end{figure}

Интересно будет посмотреть спектр получившегося сигнала. Он представлен на Рисунке.~\ref{pic:Plot12_spec}
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot12_spec}
		\caption{Спектр последовательности треугольных импульсов} 
		\label{pic:Plot12_spec} % название для ссылок внутри кода
	\end{center}
\end{figure}

Рассмотрим последовательности, которые мы можем сгенерировать при помощи пакета signal:
\begin{itemize}
\item Прямоугольная(Рисунок.~\ref{pic:Plot8})
\item Пилооразная(Рисунок.~\ref{pic:Plot9})
\end{itemize}

\lstinputlisting[
	label=code:Plot8,
	caption={Plot8.py},% для печати символ '_' требует выходной символ '\'
]{Plot8.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot8}
		\caption{Последовательность прямоугольных импульсов} 
		\label{pic:Plot8} % название для ссылок внутри кода
	\end{center}
\end{figure}

\lstinputlisting[
	label=code:Plot9,
	caption={Plot9.py},% для печати символ '_' требует выходной символ '\'
]{Plot9.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot9}
		\caption{Последовательность пилообразных импульсов} 
		\label{pic:Plot9} % название для ссылок внутри кода
	\end{center}
\end{figure}

Понаблюдаем за спектром этих сигналов на Рисунках.~\ref{pic:Plot8_spec} и .~\ref{pic:Plot9_spec}
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot8_spec}
		\caption{Спектр последовательности прямоугольных импульсов} 
		\label{pic:Plot8_spec} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot9_spec}
		\caption{Спектр последовательности пилообразных импульсов} 
		\label{pic:Plot9_spec} % название для ссылок внутри кода
	\end{center}
\end{figure}

Функцию Дирихле так же пришлось писать вручную, так как ее нет в библиотеке. Для написания используем формулу(7).

\lstinputlisting[
	label=code:Plot10,
	caption={Plot10.py},% для печати символ '_' требует выходной символ '\'
]{Plot10.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%

Так как функция Дирихле зависит от двух параметров - \textit{x} и \textit{n}, рассмотрим графики при \textit{n = 7  и n = 8}(Рисунок.~\ref{pic:Plot10_1} и Рисунок.~\ref{pic:Plot10_2}).

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot10_1}
		\caption{Функция Дирихле n = 7} 
		\label{pic:Plot10_1} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot10_2}
		\caption{Функция Дирихле n = 8} 
		\label{pic:Plot10_2} % название для ссылок внутри кода
	\end{center}
\end{figure}

Соответственно спектры для разных параметров \textit{n} представлены на Рисунках.~\ref{pic:Plot10_spec1} и ~\ref{pic:Plot10_spec2}.

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot10_spec1}
		\caption{Спектр функции Дирихле n = 7} 
		\label{pic:Plot10_spec1} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot10_spec2}
		\caption{Спектр функции Дирихле n = 8} 
		\label{pic:Plot10_spec2} % название для ссылок внутри кода
	\end{center}
\end{figure}
Стоит заметить, что оба спектра имеет общую природу.

Далее рассмотрим сигналы с менющейся мгновенной частотой. Мгновенную частоту можем менять по различным законам, подавая на вход функции chirp следующие параметры:
\begin{itemize}
\item 'linear'  (Рисунок.~\ref{pic:Plot11_1})
\item 'quadratic' (Рисунок.~\ref{pic:Plot11_2})
\item 'logarithmic' (Рисунок.~\ref{pic:Plot11_3})
\end{itemize}

\lstinputlisting[
	label=code:Plot11,
	caption={Plot11.py},% для печати символ '_' требует выходной символ '\'
]{Plot11.py}
\parindent=1cm % командна \lstinputlisting сбивает параментры отступа
%Текст без отступа (следует за вставкой)%
 На графиках получаем спектрграммы - зависимость мгновенного амплитудного спектра сигнала от времени. Величина модуля спектральной функции отображается цветом в коориднатах "время - частота".

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot11_1}
		\caption{Спектрограмма сигнала при линейном законе изменения мгновенной частоты} 
		\label{pic:Plot11_1} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot11_2}
		\caption{Спектрограмма сигнала при квадратичном законе изменения мгновенной частоты} 
		\label{pic:Plot11_2} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.7]{Plot11_3}
		\caption{Спектрограмма сигнала при экспоненциальном законе изменения мгновенной частоты} 
		\label{pic:Plot11_3} % название для ссылок внутри кода
	\end{center}
\end{figure}


\section{Выводы}
Проделав лабораторную работу, рассмотрели различные типовые сигналы часто использующиеся в ЦОС. Научились пользоваться различными библиотеками языка Python и самим языком Python. Сделали первые шаги в изучении преобразований Фурье и постороении спектров сигналов. Были постороены спектры как одиночных импульсов, так и последовательности импульсов. Построения спектров подтвердили наши ожидания о примерной форме спектра. В лабораторной работе были затронуты сигналы, которые определны только на определенных промежутках времени. Этим данные сигналы существенно отличаются от аналоговых. Стоит отметить, что в силу своей конечности, данные сигналы имеют бесконечный спектр. Говоря же о преобразовании Фурье, стоит сказать, что с его помощью мы можем переходить из одной системы координат в другую, в которой многие операции над сигналами могут быть выполнены наименее затратно и проблемно. Такой переход необходим для амплитудно-частотного анализа. Исходя из этого анализа, могут быть использованы различные фильтры для обработки сигнала или удаления шума, сигнал можеть быть сжат.
\end{document}



